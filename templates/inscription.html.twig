{# templates/securite/licensecheck.html.twig #}

{% extends "base.html.twig" %}
{% block content %}

    <div class="modal fade" id="licenceModal" tabindex="-1" role="dialog" aria-labelledby="licenceModalLabel" aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="licenceModalLabel">Erreur</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    Les mots de passe ne correspondent pas
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Fermer</button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="licenceModalPass" tabindex="-1" role="dialog" aria-labelledby="licenceModalLabel" aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="licenceModalLabel">Erreur</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    Une majuscule est 12 caractère minimum sont requis (MOT DE PASSE)
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Fermer</button>
                </div>
            </div>
        </div>
    </div>

        <div class="modal fade" id="licenceModalToken" tabindex="-1" role="dialog" aria-labelledby="licenceModalLabel" aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="licenceModalLabel">Erreur</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    Le token est invalide ou a expiré
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Fermer</button>
                </div>
            </div>
        </div>
    </div>

    {% if app.flashes('error') %}
        <script>
            $(document).ready(function(){
                $('#licenceModal').modal('show');
            });
        </script>
    {% endif %}

    {% if app.flashes('danger') %}
        <script>
            $(document).ready(function(){
                $('#licenceModalPass').modal('show');
            });
        </script>
    {% endif %}

    {% if app.flashes('token') %}
        <script>
            $(document).ready(function(){
                $('#licenceModalToken').modal('show');
            });
        </script>
    {% endif %}

    <!-- Formulaire -->
    <div class="text-center">
        <h1>Formulaire d'inscription de licencié</h1>
        
        {{ form_start(form) }}
            {{ form_row(form.licence_number, {
                'attr': {'class': 'text-field', 'placeholder': 'Numéro de licencié'}
            }) }}

            {{ form_row(form.new_pass, {
                'attr': {'class': 'text-field', 'placeholder': 'Mot de passe'}
            }) }}

            {{ form_row(form.confirm_pass, {
                'attr': {'class': 'text-field', 'placeholder': 'Mot de passe'}
            }) }}
                        
            {{ form_row(form.cancel_demand, {
                'attr': {'class': 'btn btn-primary'}
            }) }}

            {{ form_row(form.continue, {
                'attr': {'class': 'btn btn-primary'}
            }) }}
        {{ form_end(form) }}
    </div>

    <!-- Permet d'executer le submit avec le bouton entrer -->
    <script>
        document.querySelector('.text-field').addEventListener('keypress', function (e) {
            if (e.key === 'Enter') {
                e.preventDefault();
                document.querySelector('.btn.btn-primary').click();
            }
        });
    </script>
{% endblock %}
